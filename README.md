# auto_start_database_openssh
Универсальный авто запуск базы данных на компьютерах под управлением Windows и Linux

# В чем смысл?
Когда доступ к базе данных, которая находится удаленно, разрешен только с одного компьютера, но необходимо попасть В БД с других компьютеров.
Это решение использует ssh для получение доступа к БД на localhost, скрывая реальный ip компьютера, обращаясь только через один разрешенный компьютер(хост).

# Как это работает: 
Клиент слушает port хоста и обращается к хосту (вводит localhost:ip_adress в адресной строке браузера) --> SSH туннелирует запрос --> хост принимает запрос --> посылает запрос на базу данных со своим ip --> сервер принимает запрос и думает,что запросы посылаются с одного компьютера --> сервер отдает ответ хосту --> хост передает ответ клиенту


# Настройка хоста на Windows
  ❗ Если ваша сеть контролируется, допустим, VIPnet, то нужно сделать для необходимого порта TCP, на котором работает база данных(как правило, 22), исключение для туннелирования в настройках программы.
    
  Для начала скачиваем OPENSSH для вашей системы: https://github.com/PowerShell/Win32-OpenSSH/releases/tag/v9.8.3.0p2-Preview
  Для быстрой установки скачивайте файл с расширением .msi
  Далее запускаем установочный файл. Если все прошло хорошо, то программа выполнит автоустановку без ошибок.

  Создаем нового пользователя sshuser 
  net user sshuser "YourStrongPassword123!" /add

  Добавляем в группу администраторов (если нужны полные права)
  net localgroup administrators sshuser /add

  Или в группу пользователей (минимальные права)
  net localgroup users sshuser /add

  Добавляем sshd в автозагрузку
  Запустите службу SSH
  net start sshd
  Сделайте автозапуск
  sc config sshd start=auto
  
  # Настройка клиента на Windows
  Для работы ssh соединения на клиентском компьютере, требуется скачать консольную версию putty (plink.exe) для вашего компьютера(уточните перед этим вашу разрядность): https://www.chiark.greenend.org.uk/~sgtatham/putty/latest.html
  Перенести скачанный файл в C:\\WINDOWS\System32, 
  1.Скачайте файл с этого репозитория под названием start_database.bat, откройте в удобном для вас редакторе, отредактируйте строки:
  start "Tunnel SSH" plink.exe -ssh sshuser@IP-адрес хоста -pw "ПАРОЛЬ ОТ ХОСТА" -L 8080:ТУТ НУЖНЫЙ IP сайта,который пропускаем через туннель:80 -N -batch
  start "" "ТУТ АВТО ЗАПУСК НУЖНОЙ ССЫЛКИ"
  и перенести туда же ( C:\\WINDOWS\System32 ). 
  Для удобства создайте ярлык этого файла для запуска с рабочего стола.
  
  2.Зайдите в cmd и пропишите следующую команду(все поля замените на свои): plink.exe -ssh sshuser@HOST_ip_adress -pw "Пароль от хоста" -L 8080:ip_adress_site:80 -N

# чтобы запустить с клиентского LINUX: 
Проверяем, установлен ли SSH-клиент
ssh -V

Если не установлен (маловероятно для Red OS)
sudo dnf install openssh-clients

1) скачиваем DATABASE_linux 
2) в этой папке запускаем через консоль(нажать правой кнопкой мыши на свободном пространстве "открыть в терминале") команду  "./universal_install.sh"
3) По необходимости на рабочем столе даем разрешение на запуск созданным ярлыкам(нажимаем правой кнопкой мыши на ярлык и ищем пункт  "разрешить запуск")
4) запускаем ярлык


# Совместимость

Работоспособность программ тестировалось на компьютерах под управлением windows 7(32 и 64 bit) - клиенты, windows 8(64 bit) - хост и Linux RED OS 7.3 и 8 - клиенты
