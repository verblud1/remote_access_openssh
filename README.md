# auto_start_database_openssh
Универсальный авто запуск базы данных на компьютерах под управлением Windows и Linux

# В чем смысл?
Когда доступ к базе данных, которая находится удаленно, разрешен только с одного компьютера и аккаунта, но необходимо попасть В БД с других компьютеров.
Это решение использует ssh для получение доступа к БД на localhost, скрывая реальный ip компьютера, обращаясь только через один разрешенный компьютер(хост).

Как это работает: 
Клиент слушает port хоста и обращается к хосту (вводит localhost:ip_adress в адресной строке браузера) --> SSH туннелирует запрос --> хост принимает запрос --> посылает запрос на базу данных со своим ip --> сервер принимает запрос и думает,что запросы посылаются с одного компьютера --> сервер отдает ответ хосту --> хост передает ответ клиенту

# Предварительная настройка


# Запуск на Windows
  # Настройка хоста
  ❗ Если ваша сеть контролируется, допустим, VIPnet, то нужно сделать для необходимого порта TCP, на котором работает база данных(как правило, 22), исключение для туннелирования в настройках программы.
    
  Для начала скачиваем OPENSSH для вашей системы: https://github.com/PowerShell/Win32-OpenSSH/releases/tag/v9.8.3.0p2-Preview
  Для быстрой установки скачивайте файл с расширением .msi
  Далее запускаем установочный файл. Если все прошло хорошо, то программа выполнит автоустановку без ошибок.

  Создаем нового пользователя 
  net user sshuser "YourStrongPassword123!" /add

  Добавляем в группу администраторов (если нужны полные права)
  net localgroup administrators sshuser /add

  Или в группу пользователей (минимальные права)
  net localgroup users sshuser /add

  Добавляем sshd в автозагрузку
  Запустите службу SSH
  net start sshd
  Сделайте автозапуск
  sc config sshd start=auto
  
  # Настройка клиента 
  Для работы ssh соединения на клиентском компьютере, требуется скачать консольную версию putty (plink.exe) для вашего компьютера(уточните перед этим вашу разрядность): https://www.chiark.greenend.org.uk/~sgtatham/putty/latest.html
  Перенести скачанный файл в C:\\WINDOWS\System32, 
  Скачайте файл с этого репозитория под названием start_database.bat и перенести туда же. 
  Для удобства создайте ярлык этого файла для запуска с рабочего стола.


1.Перед первым запуском на клиентском windows, откройте файл start_database.bat, найдите и отредактируйте строчку plink.exe -ssh sshuser@192.168.10.59 -pw "Пароль от пользователя" -L 8080:172.30.1.18:80 -N
2.Зайдите в cmd и пропишите следующую команду(все поля замените на свои): plink.exe -ssh sshuser@USER_ip_adress -pw "Пароль от пользователя" -L 8080:ip_adress_DATABASE:80 -N

чтобы запустить БД с клиентского LINUX red os: 1) распаковываем архив DATABASE 2) в папке DATABASE запускаем через консоль(нажать правой кнопкой мыши на свободном пространстве "открыть в терминале") команду  "./universal_install.sh"  3) По необходимости на рабочем столе даем разрешение на запуск созданным ярлыкам(нажимаем правой кнопкой мыши на ярлык и ищем пункт  "разрешить запуск") 4) запускаем ярлык





# Проверяем, установлен ли SSH-клиент
ssh -V

# Если не установлен (маловероятно для Red OS)
sudo dnf install openssh-clients

# Создаем пользователя
net user sshuser "YourStrongPassword123!" /add

# Добавляем в группу администраторов (если нужны полные права)
net localgroup administrators sshuser /add

# Или в группу пользователей (минимальные права)
net localgroup users sshuser /add




# ПОДДЕРЖКА

Работоспособность программ тестировалось на компьютерах под управлением windows 7(32 и 64 bit), windows 8(64 bit) и Linux RED OS 7.3 и 8
